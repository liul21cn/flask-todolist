{% extends 'base.html' %}

{% block title %}
<title>{{ user.name }}'s Watchlist</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}" type="text/css">
{% endblock %}

{% block head %}
<h1>
    <img alt="Avatar" class="avatar" src="{{ url_for('static', filename='images/avatar.png') }}">
    {{ user.name }}'s Watchlist
</h1>
{% endblock %}

{% block content %}
<nav>
    <ul>
        <li><a href="{{ url_for('index') }}">Home</a></li>
        {% if current_user.is_authenticated %}
            <li><a href="{{ url_for('logout') }}">Logout</a> </li>
            <li><a href="{{ url_for('settings') }}">Settings</a> </li>
        {% else %}
            <li><a href="{{ url_for('login') }}">Login</a> </li>
        {% endif %}
    </ul>
</nav>
{% if current_user.is_authenticated %}
    <br>
    <form method="post">
        Title <input type="text" name="title" autocomplete="off" required>
        &nbsp&nbsp&nbsp&nbsp&nbspYear <input type="text" name="year" autocomplete="off" required>
        &nbsp&nbsp&nbsp&nbsp&nbsp <input class="submit-btn" type="submit" name="submit" value="add a movie">
    </form>
{% endif %}
<p>{{ movies|length }} Titles</p>
<ul class="movie-list">
    {% for movie in movies: %}
    <li>
        {{ movie['title'] }} - {{ movie['year'] }}
        <span class="float-right">
            <a class="douban" href="https://movie.douban.com/subject_search?search_text={{ movie.title }}"
               target="_blank" title="Find this movie on douban">豆瓣</a>
            {% if current_user.is_authenticated %}
                <a class="edit" href="{{ url_for('edit', movie_id=movie.id) }}">编辑</a>
                <form class="inline" method="post" action="{{ url_for('delete', movie_id=movie.id) }}">
                    <input class="delete" type="submit" name="delete" value="删除" onclick="return confirm('Are you sure?')">
                </form>
            {% endif %}
        </span>
    </li>
    {% endfor %}
</ul>
{% endblock %}